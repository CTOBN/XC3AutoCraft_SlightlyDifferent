XC3AutoCraft
====

**XC3AutoCraft** は**ゼノブレイド３のアクセサリークラフトを全自動で操作**するツールです。
PC上でゲーム状況を認識する**XC3StateDetector**と
Nintendo Switchにボタン入力を送信する**XC3KeyCommander**の
2つのプログラムが連動し、狙ったアクセサリーが出るまでクラフトとリロードを繰り返します。

## このアプリについて
- アクセサリークラフトに特化しているのでマクロを作る必要がありません。
- アクセサリーの**認識精度100%**
- 画面上の仮想JoyConを**クリックで操作**することでもSwitchを操作できます。 
ちょっとした操作なら物理JoyConを使わなくてもアプリ内で完結できます。
- **特殊効果に関わらずゾロ目ステータス**を目標に加えたい場合はチェックを入れるだけで設定できます。
- 目標のアクセサリーの条件をCSVファイルに保存・読み込みができます。
(読み込みはドラッグアンドドロップに対応)
- 自動開始時に4種類の画面(タイトル画面、フィールド、休憩ポイント、アクセサリークラフト)を認識します。
- 休憩ポイント、アクセサリークラフトのそれぞれの画面ではカーソルの位置も認識します。
細かい調整が面倒な人でもストレスフリーです。

## 導入方法

### 必要なもの
- キャプチャーボード (解像度1920x1080)
- HDMIケーブル 1本 (NintendoSwitch-キャプチャーボード間)
- Arduino Leonardo (Atmega32u4)
- FT232RL USB-TTLシリアル変換アダプターモジュール(以下FT232RLと呼称)
- オス-メスジャンパーワイヤー 3本
- USB Type-A ⇔ Micro USB Type-B ケーブル 2本(以下USBケーブルと呼称)

### 推奨環境
- Windows10, Windows11 (64bit)
- Arduino IDE 1.8.13
- Arduino AVR Boards 1.8.3

#### 前準備
1. Arduino LeonardoとFT232RLをジャンパーワイヤーで接続します。
2. Arduino IDE 1.8.13をダウンロードします。  
個人的にはPC環境を汚さないportable版をおすすめします。
3. arduino-1.8.13のフォルダ直下にportableという名前のフォルダを新規作成する。
4. arduino-1.8.13-windows/arduino-1.8.13/hardware/arduino/avr/boards.txt  
をメモ帳以外のテキスト編集ソフト(VSCodeなど)で開き、4箇所の数値を変更する。  
もしくは本アプリ付属のboard.txtで上書きする。
5. arduino.exeを開きXC3KeyCommander.inoをボードに書き込む
6. ボード情報を確認する
7. Nintendo SwitchのドックとArduino LeonardoをUSBケーブルで接続する。
8. FT232RLとPCをUSBケーブルで接続する。
9. キャプチャボードでNintendo Switchの映像をPCに送る。

## 使い方
1. XC3StateDetector.exeを起動する
2. 希望のアクセサリー、アクセサリーの種類、キャプチャボード、シリアルポートを選択する。 
もし特殊効果に関わらずゾロ目のアクセサリーも欲しいのであればチェックを入れる。
3. 「次へ」のボタンをクリックする。
4. キャプチャーボードからの映像が表示されるまで待機する。
5. ゼノブレイド３を起動し、任意の休憩ポイント前でセーブする。
6. 「自動クラフト開始」のボタンをクリックする
7. 完成するまで待つ

## 注意事項

1. **保証および責任の免除:** このアプリケーションは無保証で提供され、特定の目的に対する適合性も含め、いかなる保証もありません。利用者は自己のリスクでご利用ください。
2. **データ損失および機器の損傷:** Nintendo Switchの操作に関連するあらゆる損害やデータの損失に対して、作者および関連する人物は一切の責任を負いません。
3. **法的な制約の遵守:** このアプリケーションの使用は、地域および国の法的な制約に従う必要があります。Nintendo Switch利用規約 第1条第5項の「任天堂の許諾を受けていない本ゲーム機の周辺機器を使用しないこと」には該当するおそれがあります。Nintendo Switchの利用規約に違反する可能性がある場合は、使用を控えてください。

以上の点を十分に理解し、同意いただいた上で、このアプリケーションをご利用ください。作者および関連する人物は、いかなる事態においても利用者に対して一切の責任を負いません。

## ライセンス
このアプリケーションはMITライセンスで提供しています。

## データ提供


## 使用ライブラリ
XC3StateDetectorはOpenSiv3Dを使用しています。
OpenSiv3Dを含む各ライブラリのライセンスについてはアプリ実行後F1キー、またはアプリ画面上部のヘルプ->ライセンス情報からご確認ください。

XC3KeyCommanderは**NintendoSwitchControlLibrary**を使用しています。
NintendoSwitchControlLibraryのライセンスについては[https://github.com/lefmarna/NintendoSwitchControlLibrary](https://github.com/lefmarna/NintendoSwitchControlLibrary)からご確認ください。